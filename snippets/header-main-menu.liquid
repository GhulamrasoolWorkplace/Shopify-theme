{% assign menu = section.settings.main_menu %}

<nav class="main-menu">
  <ul>
    {% for link in linklists[menu].links %}
      <li>
        <a href="{{ link.url }}" class="menu-item" data-title="{{ link.title | escape }}">{{ link.title }}</a>
      </li>
    {% endfor %}
  </ul>
</nav>
<style>
  .menu-item{
    position: relative;
  }
</style>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const items = document.querySelectorAll(".menu-item");

    items.forEach((item) => {
      const title = item.getAttribute("data-title");

      // Find corresponding mega menu from DOM
      const megaMenu = document.querySelector(`[data-menu-for='${title}']`);

      if (megaMenu) {
        // Move mega menu inside this menu item as a child
        item.appendChild(megaMenu);

        item.addEventListener("mouseenter", () => {
          megaMenu.style.display = "block";
        });

        item.addEventListener("mouseleave", () => {
          megaMenu.style.display = "none";
        });

        megaMenu.addEventListener("mouseenter", () => {
          megaMenu.style.display = "block";
        });

        megaMenu.addEventListener("mouseleave", () => {
          megaMenu.style.display = "none";
        });
      }
    });
  });
</script>
